<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
    <link rel="stylesheet" href="/client/signin.css" type="text/css">
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
    <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/toastify-js/src/toastify.min.css">
    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/toastify-js"></script>

    <title>Badeflix</title>

  </head>

  <body>
    <nav class="navbar navbar-expand-lg navbar-light bg-light">
      <!-- / bedeutet home root also localhost:300/ -->
      <a class="navbar-brand" href="/">
        <!-- to include badeflix logo -->
        <img src="/resources/Logo2.png" alt="Badeflix Logo" height="50">
      </a>
    </nav>

    <main class="container center-vertical">

      <form class="signin-form" id="signin-form">
        <h2 class="mb-5">Jetzt einloggen!</h2>

        <div class="form-group">
          <label for="email">Email Adresse</label>
          <input type="email" class="form-control" id="email" aria-describedby="emailHelp" placeholder="Email eingeben">
        </div>

        <div class="form-group">
          <label for="password">Passwort</label>
          <input type="password" class="form-control" id="password" placeholder="Passwort eingeben">
        </div>

        <small class="form-text text-muted mb-3">
          Noch keinen Account? Jetzt <a href="/signup.html">registrieren!</a>
        </small>

        <button type="submit" class="btn btn-primary full-width">Einloggen</button>
      </form>
    </main>

    <script>
      const form = document.querySelector('#signin-form');

      form.addEventListener('submit', async (event) => {
        event.preventDefault();

        const email = document.querySelector('#email').value;
        const password = document.querySelector('#password').value;

        try {
          const {data} = await axios.post('v1/user/signin', {
            email,
            password
          });

          window.location.href = "/";

        } catch(_) {
          Toastify({
            text: "Ung√ºltige Einlogdaten!",
            duration: 3000,
            backgroundColor: "red",
          }).showToast();
        }
      });
    </script>
  </body>
</html>
